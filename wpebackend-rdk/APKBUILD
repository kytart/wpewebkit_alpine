# Maintainer: signageOS <dev@signageos.io>
pkgname="wpebackend-rdk"
pkgver="1.0"
pkgrel=0
pkgdesc="wpebackend-rdk"
url="https://wpewebkit.org"
arch="armhf armv7"
license="custom"
depends="libxkbcommon libwpe raspberrypi libinput"
makedepends="cmake ninja eudev-dev libxkbcommon-dev glib-dev libinput-dev raspberrypi-dev"
options="!check"
_commitid="e3f442523072444c0202b508f3688d9026f9c41f"
source="
    $pkgname-$pkgver.tar.gz::https://github.com/WebPlatformForEmbedded/WPEBackend-rdk/archive/$_commitid.tar.gz
    bcm-rpi-cmake.patch
    fix.patch
"
builddir="$srcdir"/WPEBackend-rdk-$_commitid

build() {
    cd "$builddir"
    export PKG_CONFIG_PATH=/opt/vc/lib/pkgconfig
    cmake \
        -DCMAKE_BUILD_TYPE=RelWithDebInfo \
        -DCMAKE_INSTALL_PREFIX=/usr \
        -DUSE_BACKEND_BCM_RPI=ON \
        -GNinja
    ninja
}

package() {
    cd "$builddir"
    DESTDIR="$pkgdir" ninja install
}

sha512sums="157fd4f53f2ea74af41409e81cf731ec85983210951a8f303ad3baece45876bc949d5d467702f532fffd10dfbdcaf29795896065395b3318b1b53a0863ffae78  wpebackend-rdk-1.0.tar.gz
a03b78815d2650ae6d0a5bea5c248cf6fd8af7ea5feafd3cbac6089b6917f4b4f0e991866b5bcbe7d68f44756dddbcc605d36ca2b2dba7749b6ca821c6fa3d60  bcm-rpi-cmake.patch"
